# Force one of your slaves to start working as a prostitute.
# Overridden from Carnalitas
carn_force_start_prostitution_interaction = {
	category = interaction_category_uncategorized
	desc = carn_force_start_prostitution_interaction_desc
	interface_priority = 100
	common_interaction = yes
	icon = cpr_prostitution

	is_shown = {
		NOT = { has_game_rule = carn_slavery_content_disabled }
		scope:actor = {
			has_relation_slave = scope:recipient
			carn_legal_prostitution_trigger = yes
		}
		scope:recipient = {
			cpr_is_slave_trigger = yes
			carn_can_be_prostitute_trigger = yes
			carn_is_working_as_prostitute_trigger = no
		}
	}

	is_valid_showing_failures_only = {
		scope:actor = {
			cpr_can_start_interaction_trigger = yes
			custom_description = {
				text = "carn_cannot_have_max_number_of_slave_prostitutes"
				any_relation = {
					type = slave
					carn_is_working_as_prostitute_trigger = yes
					count < carn_max_slave_prostitutes_per_owner
				}
			}
		}
		scope:recipient = {
			save_temporary_scope_as = force_start_prostitution_interaction
			cpr_can_work_as_prostitute_trigger = yes
			cpr_slave_has_pending_transaction = no
		}
	}

	on_accept = {
		save_scope_value_as = { name = cpr_event value = flag:interaction }
		scope:actor = {
			cpr_force_start_prostitution_interaction_effect = { SLAVE = scope:recipient }
		}
	}

	auto_accept = yes

	ai_min_reply_days = 0
	ai_max_reply_days = 0

	ai_targets = {
		ai_recipients = scripted_relations
	}

	ai_frequency = 24

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = -5

		# Opinion of slave (-25 to 25 depending on opinion)
		opinion_modifier = {
			trigger = {
				NOT = { scope:actor = scope:recipient }
			}
			opinion_target = scope:recipient
			multiplier = -0.25
		}

		# Greed (-25 to 25 depending on greed)
		modifier = {
			ai_greed = 0.25
		}

		# Compassion (-25 to 25 depending on compassion)
		ai_value_modifier = {
			ai_compassion = -0.25
		}

		# Honor (-10 to 10 depending on honor)
		ai_value_modifier = {
			ai_honor = -0.10
		}

		# Zeal (-50 to 0 depending on zeal if prostitution is not accepted)
		modifier = {
			carn_accepts_prostitution_trigger = no
			add = {
				value = ai_zeal
				multiply = 0.01
				add = 1
				multiply = -25
			}
		}

		# Family or dynasty (-50, x4 for children, x2 for close family, x0.5 for just dynasty, modified by compassion)
		# Reluctant to prostitute family or dynasty
		cpr_family_or_dynasty_modifier = {
			CHARACTER = scope:recipient
			BASE = -50
		}

		# Friend or lover (-100, doubled for best friend / soulmate, modified by compassion)
		# Reluctant to prostitute friends or lover
		cpr_friend_or_lover_modifier = {
			CHARACTER = scope:recipient
			BASE = -100
		}

		# Rival (50, doubled for nemesis, modified by vengefulness)
		cpr_rival_modifier = {
			CHARACTER = scope:recipient
			BASE = 50
		}

		# Already employed (-25, doubled for council / court positions)
		cpr_employed_modifier = {
			CHARACTER = scope:recipient
			RULER = scope:actor
			BASE = -25
		}

		# Already a prostitute (0 to 25 depending on trait XP)
		modifier = {
			scope:recipient = {
				carn_is_prostitute_trigger = yes
			}
			add = {
				scope:recipient = {
					value = "has_trait_xp(lifestyle_prostitute)"
					multiply = 0.25
				}
			}
		}

		# Skills (-5 to 5+)
		modifier = {
			add = {
				value = scope:recipient.diplomacy
				subtract = 10
				multiply = 0.25
			}
		}
		modifier = {
			add = {
				value = scope:recipient.intrigue
				subtract = 10
				multiply = 0.25
			}
		}

		# Attraction (-7 to 7)
		modifier = {
			add = {
				value = scope:recipient.attraction
				multiply = 0.25
			}
		}
	}
}
